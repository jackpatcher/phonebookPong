<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏™‡∏°‡∏∏‡∏î‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap');
        
        * {
            font-family: 'Sarabun', sans-serif;
        }
        
        .slide-in {
            animation: slideIn 0.3s ease-out;
        }
        
        .slide-out {
            animation: slideOut 0.3s ease-in;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }
        
        @keyframes slideOut {
            from { transform: translateX(0); }
            to { transform: translateX(100%); }
        }
        
        .fade-in {
            animation: fadeIn 0.2s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }
        
        .bounce-in {
            animation: bounceIn 0.4s ease-out;
        }
        
        @keyframes bounceIn {
            0% { transform: scale(0.3); opacity: 0; }
            50% { transform: scale(1.05); }
            70% { transform: scale(0.9); }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .contact-card {
            transition: all 0.3s ease;
        }
        
        .contact-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        .category-badge {
            transition: all 0.2s ease;
        }
        
        .category-badge:hover {
            transform: scale(1.05);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <!-- Header -->
    <div class="bg-white shadow-lg sticky top-0 z-50">
        <div class="max-w-md mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <h1 class="text-xl font-bold text-gray-800">üìû ‡∏™‡∏°‡∏∏‡∏î‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</h1>
                <div class="flex space-x-2">
                    <button onclick="showAddContact()" class="bg-blue-500 hover:bg-blue-600 text-white p-2 rounded-full transition-all duration-200 hover:scale-110">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                        </svg>
                    </button>
                    <button onclick="showSettings()" class="bg-gray-500 hover:bg-gray-600 text-white p-2 rounded-full transition-all duration-200 hover:scale-110">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="max-w-md mx-auto px-4 py-6">
        <!-- Search Bar -->
        <div class="mb-6">
            <div class="relative">
                <input type="text" id="searchInput" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£..." 
                       class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                       oninput="searchContacts()">
                <svg class="absolute left-3 top-3.5 w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                </svg>
            </div>
        </div>

        <!-- Category Filter -->
        <div class="mb-6">
            <div class="flex flex-wrap gap-2" id="categoryFilter">
                <button onclick="filterByCategory('all')" class="category-badge bg-blue-500 text-white px-4 py-2 rounded-full text-sm font-medium">
                    ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                </button>
            </div>
        </div>

        <!-- Contacts List -->
        <div id="contactsList" class="space-y-4">
            <!-- Contacts will be rendered here -->
        </div>
    </div>

    <!-- Add/Edit Contact Modal -->
    <div id="contactModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-2xl w-full max-w-md p-6 fade-in">
                <div class="flex items-center justify-between mb-6">
                    <h2 id="modalTitle" class="text-xl font-bold text-gray-800">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏´‡∏°‡πà</h2>
                    <button onclick="closeContactModal()" class="text-gray-500 hover:text-gray-700">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
                
                <form id="contactForm" onsubmit="saveContact(event)">
                    <!-- Profile Image -->
                    <div class="mb-6 text-center">
                        <div class="relative inline-block">
                            <div id="profilePreview" class="w-24 h-24 bg-gray-200 rounded-full flex items-center justify-center text-3xl text-gray-500 mx-auto mb-3">
                                üë§
                            </div>
                            <button type="button" onclick="document.getElementById('imageInput').click()" 
                                    class="absolute bottom-0 right-0 bg-blue-500 text-white p-2 rounded-full hover:bg-blue-600 transition-colors">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"></path>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                </svg>
                            </button>
                            <input type="file" id="imageInput" accept="image/*" class="hidden" onchange="previewImage(event)">
                        </div>
                    </div>

                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
                            <input type="text" id="contactName" required 
                                   class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</label>
                            <input type="tel" id="contactPhone" required 
                                   class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</label>
                            <select id="contactCategory" required 
                                    class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                <!-- Categories will be populated here -->
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</label>
                            <input type="text" id="contactPosition" 
                                   class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                    </div>
                    
                    <div class="flex space-x-3 mt-8">
                        <button type="button" onclick="closeContactModal()" 
                                class="flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors">
                            ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                        </button>
                        <button type="submit" 
                                class="flex-1 px-4 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors">
                            ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-2xl w-full max-w-md p-6 fade-in">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-xl font-bold text-gray-800">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</h2>
                    <button onclick="closeSettings()" class="text-gray-500 hover:text-gray-700">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
                
                <!-- Add New Category -->
                <div class="mb-6">
                    <div class="flex space-x-2">
                        <input type="text" id="newCategoryInput" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡πÉ‡∏´‡∏°‡πà" 
                               class="flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <button onclick="addCategory()" 
                                class="px-4 py-3 bg-green-500 text-white rounded-xl hover:bg-green-600 transition-colors">
                            ‡πÄ‡∏û‡∏¥‡πà‡∏°
                        </button>
                    </div>
                </div>
                
                <!-- Categories List -->
                <div class="space-y-3" id="categoriesList">
                    <!-- Categories will be rendered here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Data Storage
        let contacts = JSON.parse(localStorage.getItem('phoneBookContacts')) || [
            {
                id: 1,
                name: '‡∏ô‡∏≤‡∏¢‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ',
                phone: '02-123-4567',
                category: '‡∏ù‡πà‡∏≤‡∏¢‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£',
                position: '‡∏ú‡∏π‡πâ‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Å‡∏≤‡∏£',
                image: null
            },
            {
                id: 2,
                name: '‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏™‡∏∏‡∏î‡∏≤ ‡∏£‡∏±‡∏Å‡∏á‡∏≤‡∏ô',
                phone: '081-234-5678',
                category: '‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô',
                position: '‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏ö‡∏±‡∏ç‡∏ä‡∏µ',
                image: null
            },
            {
                id: 3,
                name: '‡∏ô‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏±‡∏¢ ‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å',
                phone: '089-345-6789',
                category: '‡∏ù‡πà‡∏≤‡∏¢‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ',
                position: '‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡πÄ‡∏°‡∏≠‡∏£‡πå',
                image: null
            },
            {
                id: 4,
                name: '‡∏ô‡∏≤‡∏á‡∏°‡∏≤‡∏•‡∏µ ‡∏Ç‡∏≤‡∏¢‡πÄ‡∏Å‡πà‡∏á',
                phone: '092-456-7890',
                category: '‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î',
                position: '‡∏ô‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î',
                image: null
            },
            {
                id: 5,
                name: '‡∏ô‡∏≤‡∏¢‡∏õ‡∏£‡∏∞‡∏ä‡∏≤ ‡∏î‡∏π‡πÅ‡∏•‡∏î‡∏µ',
                phone: '063-567-8901',
                category: '‡∏ù‡πà‡∏≤‡∏¢‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•',
                position: '‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà HR',
                image: null
            }
        ];
        let categories = JSON.parse(localStorage.getItem('phoneBookCategories')) || [
            '‡∏ù‡πà‡∏≤‡∏¢‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£',
            '‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô',
            '‡∏ù‡πà‡∏≤‡∏¢‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•',
            '‡∏ù‡πà‡∏≤‡∏¢‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ',
            '‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î'
        ];
        let currentEditId = null;
        let currentFilter = 'all';

        // Initialize App
        function initApp() {
            renderContacts();
            renderCategoryFilter();
            populateCategorySelect();
            renderCategoriesList();
        }

        // Render Contacts
        function renderContacts() {
            const contactsList = document.getElementById('contactsList');
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            
            let filteredContacts = contacts.filter(contact => {
                const matchesSearch = contact.name.toLowerCase().includes(searchTerm) || 
                                    contact.phone.includes(searchTerm);
                const matchesCategory = currentFilter === 'all' || contact.category === currentFilter;
                return matchesSearch && matchesCategory;
            });

            if (filteredContacts.length === 0) {
                contactsList.innerHTML = `
                    <div class="text-center py-12">
                        <div class="text-6xl mb-4">üì±</div>
                        <p class="text-gray-500">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</p>
                    </div>
                `;
                return;
            }

            contactsList.innerHTML = filteredContacts.map(contact => `
                <div class="contact-card bg-white rounded-2xl p-4 shadow-md">
                    <div class="flex items-center space-x-4">
                        <div class="w-16 h-16 rounded-full overflow-hidden bg-gray-200 flex-shrink-0">
                            ${contact.image ? 
                                `<img src="${contact.image}" alt="${contact.name}" class="w-full h-full object-cover">` :
                                `<div class="w-full h-full flex items-center justify-center text-2xl text-gray-500">üë§</div>`
                            }
                        </div>
                        <div class="flex-1 min-w-0">
                            <h3 class="font-semibold text-gray-800 truncate">${contact.name}</h3>
                            <p class="text-blue-600 font-medium">${contact.phone}</p>
                            ${contact.position ? `<p class="text-sm text-gray-500">${contact.position}</p>` : ''}
                            <span class="inline-block mt-1 px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full">
                                ${contact.category}
                            </span>
                        </div>
                        <div class="flex flex-col space-y-2">
                            <button onclick="callContact('${contact.phone}')" 
                                    class="bg-green-500 hover:bg-green-600 text-white p-3 rounded-full transition-all duration-200 hover:scale-110">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                                </svg>
                            </button>
                            <button onclick="editContact(${contact.id})" 
                                    class="bg-blue-500 hover:bg-blue-600 text-white p-3 rounded-full transition-all duration-200 hover:scale-110">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Render Category Filter
        function renderCategoryFilter() {
            const categoryFilter = document.getElementById('categoryFilter');
            const allButton = `
                <button onclick="filterByCategory('all')" 
                        class="category-badge ${currentFilter === 'all' ? 'bg-blue-500 text-white' : 'bg-gray-200 text-gray-700'} px-4 py-2 rounded-full text-sm font-medium">
                    ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                </button>
            `;
            
            const categoryButtons = categories.map(category => `
                <button onclick="filterByCategory('${category}')" 
                        class="category-badge ${currentFilter === category ? 'bg-blue-500 text-white' : 'bg-gray-200 text-gray-700'} px-4 py-2 rounded-full text-sm font-medium">
                    ${category}
                </button>
            `).join('');
            
            categoryFilter.innerHTML = allButton + categoryButtons;
        }

        // Filter by Category
        function filterByCategory(category) {
            currentFilter = category;
            renderCategoryFilter();
            renderContacts();
        }

        // Search Contacts
        function searchContacts() {
            renderContacts();
        }

        // Call Contact
        function callContact(phone) {
            // Remove any non-digit characters except +
            const cleanPhone = phone.replace(/[^\d+]/g, '');
            window.location.href = `tel:${cleanPhone}`;
        }

        // Show Add Contact Modal
        function showAddContact() {
            currentEditId = null;
            document.getElementById('modalTitle').textContent = '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏´‡∏°‡πà';
            document.getElementById('contactForm').reset();
            document.getElementById('profilePreview').innerHTML = 'üë§';
            document.getElementById('contactModal').classList.remove('hidden');
        }

        // Edit Contact
        function editContact(id) {
            const contact = contacts.find(c => c.id === id);
            if (!contact) return;
            
            currentEditId = id;
            document.getElementById('modalTitle').textContent = '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠';
            document.getElementById('contactName').value = contact.name;
            document.getElementById('contactPhone').value = contact.phone;
            document.getElementById('contactCategory').value = contact.category;
            document.getElementById('contactPosition').value = contact.position || '';
            
            if (contact.image) {
                document.getElementById('profilePreview').innerHTML = 
                    `<img src="${contact.image}" alt="${contact.name}" class="w-full h-full object-cover rounded-full">`;
            } else {
                document.getElementById('profilePreview').innerHTML = 'üë§';
            }
            
            document.getElementById('contactModal').classList.remove('hidden');
        }

        // Preview Image
        function previewImage(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('profilePreview').innerHTML = 
                        `<img src="${e.target.result}" alt="Preview" class="w-full h-full object-cover rounded-full">`;
                };
                reader.readAsDataURL(file);
            }
        }

        // Save Contact
        function saveContact(event) {
            event.preventDefault();
            
            const name = document.getElementById('contactName').value;
            const phone = document.getElementById('contactPhone').value;
            const category = document.getElementById('contactCategory').value;
            const position = document.getElementById('contactPosition').value;
            const imageInput = document.getElementById('imageInput');
            
            const contactData = {
                name,
                phone,
                category,
                position
            };
            
            if (imageInput.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    contactData.image = e.target.result;
                    saveContactData(contactData);
                };
                reader.readAsDataURL(imageInput.files[0]);
            } else {
                if (currentEditId) {
                    const existingContact = contacts.find(c => c.id === currentEditId);
                    if (existingContact && existingContact.image) {
                        contactData.image = existingContact.image;
                    }
                }
                saveContactData(contactData);
            }
        }

        function saveContactData(contactData) {
            if (currentEditId) {
                const index = contacts.findIndex(c => c.id === currentEditId);
                contacts[index] = { ...contactData, id: currentEditId };
            } else {
                contactData.id = Date.now();
                contacts.push(contactData);
            }
            
            localStorage.setItem('phoneBookContacts', JSON.stringify(contacts));
            closeContactModal();
            renderContacts();
        }

        // Close Contact Modal
        function closeContactModal() {
            document.getElementById('contactModal').classList.add('hidden');
        }

        // Populate Category Select
        function populateCategorySelect() {
            const select = document.getElementById('contactCategory');
            select.innerHTML = categories.map(category => 
                `<option value="${category}">${category}</option>`
            ).join('');
        }

        // Show Settings
        function showSettings() {
            document.getElementById('settingsModal').classList.remove('hidden');
            renderCategoriesList();
        }

        // Close Settings
        function closeSettings() {
            document.getElementById('settingsModal').classList.add('hidden');
        }

        // Add Category
        function addCategory() {
            const input = document.getElementById('newCategoryInput');
            const categoryName = input.value.trim();
            
            if (categoryName && !categories.includes(categoryName)) {
                categories.push(categoryName);
                localStorage.setItem('phoneBookCategories', JSON.stringify(categories));
                input.value = '';
                renderCategoriesList();
                populateCategorySelect();
                renderCategoryFilter();
            }
        }

        // Delete Category
        function deleteCategory(categoryName) {
            if (confirm(`‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà "${categoryName}" ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?`)) {
                categories = categories.filter(cat => cat !== categoryName);
                // Update contacts that use this category
                contacts = contacts.map(contact => {
                    if (contact.category === categoryName) {
                        contact.category = categories[0] || '‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ';
                    }
                    return contact;
                });
                
                localStorage.setItem('phoneBookCategories', JSON.stringify(categories));
                localStorage.setItem('phoneBookContacts', JSON.stringify(contacts));
                
                renderCategoriesList();
                populateCategorySelect();
                renderCategoryFilter();
                renderContacts();
            }
        }

        // Render Categories List
        function renderCategoriesList() {
            const categoriesList = document.getElementById('categoriesList');
            categoriesList.innerHTML = categories.map(category => `
                <div class="flex items-center justify-between p-3 bg-gray-50 rounded-xl">
                    <span class="font-medium text-gray-800">${category}</span>
                    <button onclick="deleteCategory('${category}')" 
                            class="text-red-500 hover:text-red-700 p-1">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                        </svg>
                    </button>
                </div>
            `).join('');
        }

        // Initialize app when page loads
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97b71a0e1102893b',t:'MTc1NzI1NzUwMC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
